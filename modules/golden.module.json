{
  "seed": 1,
  "start": {
    "map": "world",
    "x": 7,
    "y": 7
  },
  "items": [
    {
      "id": "golden_coin",
      "name": "Golden Coin",
      "type": "quest",
      "value": 1
    },
    {
      "id": "thanks_medal",
      "name": "Thanks Medal",
      "type": "trinket",
      "slot": "trinket",
      "mods": {
        "LCK": 1
      },
      "value": 10
    },
    {
      "id": "bonus_potion",
      "name": "Healing Potion",
      "type": "consumable",
      "use": {
        "type": "heal",
        "amount": 5
      },
      "value": 5
    },
    {
      "map": "world",
      "x": 6,
      "y": 7,
      "id": "spare_potion",
      "name": "Spare Potion",
      "type": "consumable",
      "use": {
        "type": "heal",
        "amount": 5
      },
      "value": 5
    },
    {
      "id": "makeshift_charge",
      "name": "Makeshift Charge",
      "type": "quest"
    },
    {
      "map": "world",
      "x": 8,
      "y": 7,
      "id": "chest_key",
      "name": "Chest Key",
      "type": "quest",
      "tags": ["key"]
    }
  ],
  "quests": [
    {
      "id": "q_fetch",
      "title": "Fetch the Coin",
      "desc": "Retrieve the coin from the cabin.",
      "item": "golden_coin",
      "reward": "thanks_medal",
      "xp": 2
    }
  ],
  "npcs": [
    {
      "id": "villager",
      "map": "world",
      "x": 7,
      "y": 8,
      "color": "#cfa",
      "name": "Worried Villager",
      "desc": "Lost a coin in the cabin.",
      "prompt": "Anxious villager clutching an empty coin pouch",
      "questId": "q_fetch",
      "tree": {
        "start": {
          "text": "My lucky coin is in the cabin. Can you fetch it?",
          "choices": [
            {
              "label": "(Accept)",
              "to": "accept",
              "q": "accept"
            },
            {
              "label": "(INT) Any advance?",
              "to": "advance",
              "check": {
                "stat": "INT",
                "dc": 5
              }
            },
            {
              "label": "(Leave)",
              "to": "bye"
            }
          ]
        },
        "advance": {
          "text": "Sharp mind! Take this potion.",
          "choices": [
            {
              "label": "(Thanks)",
              "to": "accept",
              "reward": "bonus_potion",
              "q": "accept"
            }
          ]
        },
        "accept": {
          "text": "Please bring it soon.",
          "choices": [
            {
              "label": "(I have the coin)",
              "to": "turnin",
              "q": "turnin"
            },
            {
              "label": "(Leave)",
              "to": "bye"
            }
          ]
        },
        "turnin": {
          "text": "You found it! Here is your reward.",
          "choices": [
            {
              "label": "(Continue)",
              "to": "bye",
              "reward": "thanks_medal"
            }
          ]
        }
      }
    },
    {
      "id": "chest",
      "map": "cabin",
      "x": 3,
      "y": 2,
      "color": "#ddf",
      "name": "Dusty Chest",
      "desc": "Maybe it holds the coin.",
      "prompt": "Dusty wooden chest bound by a metal lock",
      "symbol": "?",
      "locked": true,
      "tree": {
        "locked": {
          "text": "A locked chest sits here.",
          "choices": [
            { "label": "(Use Key)", "to": "open", "once": true, "reqItem": "chest_key", "effects": [ { "effect": "unlockNPC", "npcId": "chest" } ] },
            { "label": "(Use Explosive)", "to": "open", "once": true, "reqItem": "makeshift_charge", "effects": [ { "effect": "unlockNPC", "npcId": "chest" } ] },
            { "label": "(Pry with Crowbar)", "to": "crowbar_open", "once": true, "reqItem": "crowbar", "effects": [ { "effect": "unlockNPC", "npcId": "chest" } ] },
            { "label": "(Leave)", "to": "bye" }
          ]
        },
        "open": {
          "text": "The chest creaks open, revealing a shiny coin.",
          "choices": [
            { "label": "(Take Coin)", "to": "empty", "reward": "golden_coin", "effects": [ { "effect": "addFlag", "flag": "chest_looted" } ] }
          ]
        },
        "crowbar_open": {
          "text": "The crowbar pops the lid with a squeal.",
          "choices": [
            { "label": "(Take Coin)", "to": "empty", "reward": "golden_coin", "effects": [ { "effect": "addFlag", "flag": "chest_looted" } ] }
          ]
        },
        "empty": {
          "text": "The chest is empty.",
          "choices": [
            { "label": "(Lock Chest)", "to": "locked_empty", "reqItem": "chest_key", "effects": [ { "effect": "lockNPC", "npcId": "chest" } ] },
            { "label": "(Leave)", "to": "bye" }
          ]
        },
        "locked_empty": {
          "text": "The chest is empty and locked.",
          "choices": [
            { "label": "(Leave)", "to": "bye" }
          ]
        }
      }
    },
    {
      "id": "rat",
      "map": "cabin",
      "x": 5,
      "y": 2,
      "color": "#f88",
      "name": "Big Rat",
      "title": "Pest",
      "desc": "It guards the cabin.",
      "prompt": "Large cabin rat with matted fur",
      "tree": {
        "start": {
          "text": "The rat snarls.",
          "choices": [
            {
              "label": "(Leave)",
              "to": "bye"
            }
          ]
        }
      },
      "combat": {
        "HP": 4,
        "ATK": 2,
        "DEF": 0,
        "loot": null,
        "auto": true
      }
    },
    {
      "id": "bandit",
      "map": "world",
      "x": 12,
      "y": 8,
      "color": "#f66",
      "name": "Sneaky Bandit",
      "desc": "Blocks the path.",
      "prompt": "Sneaky bandit with a crooked dagger",
      "tree": {
        "start": {
          "text": "Hand over your loot!",
          "choices": [
            {
              "label": "(Leave)",
              "to": "bye"
            }
          ]
        }
      },
      "combat": {
        "HP": 6,
        "ATK": 3,
        "DEF": 1,
        "loot": null,
        "auto": true
      }
    },
    {
      "id": "scout",
      "map": "world",
      "x": 9,
      "y": 6,
      "color": "#afa",
      "name": "Friendly Scout",
      "desc": "Offers to join your journey.",
      "prompt": "Friendly scout with travel gear",
      "tree": {
        "start": {
          "text": "Need a companion?",
          "choices": [
            {
              "label": "(Join me)",
              "to": "join",
              "join": {
                "id": "scout",
                "name": "Scout",
                "role": "Guide"
              }
            },
            {
              "label": "(Leave)",
              "to": "bye"
            }
          ]
        },
        "join": {
          "text": "Let's go.",
          "choices": [
            {
              "label": "(Leave)",
              "to": "bye"
            }
          ]
        }
      }
    },
    {
      "id": "trader",
      "map": "world",
      "x": 5,
      "y": 8,
      "color": "#caffc6",
      "name": "Traveling Trader",
      "desc": "Sells basic goods.",
      "prompt": "Traveling trader carrying a pack of goods",
      "shop": {
        "markup": 2,
        "inv": [
          {
            "id": "bonus_potion"
          }
        ]
      },
      "tree": {
        "start": {
          "text": "Trade wares?",
          "choices": [
            {
              "label": "(Leave)",
              "to": "bye"
            }
          ]
        }
      }
    },
    {
      "id": "wanderer",
      "hidden": true,
      "map": "world",
      "x": 4,
      "y": 7,
      "color": "#b8ffb6",
      "name": "Mysterious Wanderer",
      "desc": "Appears after you linger.",
      "prompt": "Cloaked wanderer emerging from the dust",
      "tree": {
        "start": {
          "text": "You finally noticed me.",
          "choices": [
            {
              "label": "(Leave)",
              "to": "bye"
            }
          ]
        }
      },
      "reveal": {
        "flag": "visits@world@7,7",
        "op": ">=",
        "value": 3
      }
    },
    {
      "id": "dialog_tester",
      "map": "world",
      "x": 7,
      "y": 17,
      "color": "#fcc",
      "name": "Dialog Tester",
      "desc": "Demonstrates advanced dialog options.",
      "prompt": "Curious tester with a worn notebook",
      "tree": {
        "start": {
          "text": "Pick a feature to test.",
          "choices": [
            {
              "label": "(Check STR)",
              "to": "dc"
            },
            {
              "label": "(Gain XP)",
              "to": "xp"
            },
            {
              "label": "(Require Coin)",
              "to": "req_item"
            },
            {
              "label": "(Need Trinket)",
              "to": "req_slot"
            },
            {
              "label": "(Move Me)",
              "to": "move"
            },
            {
              "label": "(Leave)",
              "to": "bye"
            }
          ]
        },
        "dc": {
          "text": "Let's see your strength.",
          "choices": [
            {
              "label": "(Roll)",
              "to": "start",
              "check": {
                "stat": "STR",
                "dc": 5
              },
              "success": "Impressive!",
              "failure": "Not strong enough."
            }
          ]
        },
        "xp": {
          "text": "Testing experience award.",
          "choices": [
            {
              "label": "(Earn XP)",
              "to": "start",
              "reward": "XP 1",
              "success": "You feel wiser."
            }
          ]
        },
        "req_item": {
          "text": "Do you carry the coin?",
          "choices": [
            {
              "label": "(Use Coin)",
              "to": "start",
              "reqItem": "golden_coin",
              "success": "Thanks for the coin.",
              "failure": "Bring me the Golden Coin."
            }
          ]
        },
        "req_slot": {
          "text": "Show me any trinket.",
          "choices": [
            {
              "label": "(Show Trinket)",
              "to": "start",
              "reqSlot": "trinket",
              "success": "Nice trinket!",
              "failure": "You lack a trinket."
            }
          ]
        },
        "move": {
          "text": "I can move at your request.",
          "choices": [
            {
              "label": "(Step North)",
              "to": "start",
              "goto": {
                "target": "npc",
                "rel": true,
                "y": -1
              },
              "success": "I moved north."
            }
          ]
        }
      }
    },
    {
      "id": "nyx",
      "map": "world",
      "x": 4,
      "y": 15,
      "color": "#ccf",
      "name": "Nyx",
      "desc": "A wanderer with layered stories.",
      "prompt": "Story-laden wanderer with a calm gaze",
      "tree": {
        "start": {
          "text": "Greetings, traveler. What do you seek?",
          "choices": [
            { "label": "Who are you?", "to": "who" },
            { "label": "Tell me a tale", "to": "tale" },
            { "label": "(Leave)", "to": "bye" }
          ]
        },
        "who": {
          "text": "I am Nyx. Do you seek wisdom or power?",
          "choices": [
            { "label": "Wisdom", "to": "wisdom" },
            { "label": "Power", "to": "power" },
            { "label": "(Back)", "to": "start" }
          ]
        },
        "wisdom": {
          "text": "Wisdom requires patience. Proceed?",
          "choices": [
            { "label": "Yes", "to": "lesson" },
            { "label": "No", "to": "start" }
          ]
        },
        "lesson": {
          "text": "The dust remembers those who listen. Ask further?",
          "choices": [
            { "label": "Tell me more", "to": "secret" },
            { "label": "That's enough", "to": "start" }
          ]
        },
        "secret": {
          "text": "You carry the weight of forgotten tales.",
          "choices": [
            { "label": "(Leave)", "to": "bye" }
          ]
        },
        "power": {
          "text": "Power corrupts. Do you still want it?",
          "choices": [
            { "label": "Yes", "to": "trial" },
            { "label": "No", "to": "start" }
          ]
        },
        "trial": {
          "text": "Face the trial another time.",
          "choices": [
            { "label": "(Back)", "to": "start" }
          ]
        },
        "tale": {
          "text": "What kind of tale?",
          "choices": [
            { "label": "Heroic", "to": "heroic" },
            { "label": "Tragic", "to": "tragic" },
            { "label": "(Back)", "to": "start" }
          ]
        },
        "heroic": {
          "text": "A hero rose from dust.",
          "choices": [
            { "label": "(Back)", "to": "tale" }
          ]
        },
        "tragic": {
          "text": "The sand swallowed cities.",
          "choices": [
            { "label": "(Back)", "to": "tale" }
          ]
        }
      }
    },
    {
      "id": "mara",
      "map": "world",
      "x": 5,
      "y": 14,
      "color": "#fac",
      "name": "Mara",
      "desc": "Steely-eyed survivor.",
      "prompt": "Steely survivor with determined eyes",
      "tree": {
        "start": {
          "text": "The dust never settles, does it?",
          "choices": [
            { "label": "Stay sharp.", "to": "resolve" }
          ]
        },
        "resolve": {
          "text": "Always.",
          "choices": [
            { "label": "(Leave)", "to": "bye" }
          ]
        }
      }
    },
    {
      "id": "jax",
      "map": "world",
      "x": 8,
      "y": 14,
      "color": "#acf",
      "name": "Jax",
      "desc": "Tinker with a grin.",
      "prompt": "Grinning tinkerer holding a spare fuse",
      "tree": {
        "start": {
          "text": "Got a spare fuse?",
          "choices": [
            { "label": "Maybe later.", "to": "later" }
          ]
        },
        "later": {
          "text": "I'll hold you to that.",
          "choices": [
            { "label": "(Leave)", "to": "bye" }
          ]
        }
      }
    }
  ],
  "events": [
    {
      "map": "world",
      "x": 6,
      "y": 6,
      "events": [
        {
          "when": "enter",
          "effect": "toast",
          "msg": "A warm breeze soothes you."
        },
        {
          "when": "enter",
          "effect": "modStat",
          "stat": "CHA",
          "delta": 1,
          "duration": 2
        }
      ]
    }
  ],
  "portals": [
    {
      "map": "world",
      "x": 9,
      "y": 6,
      "toMap": "world",
      "toX": 1,
      "toY": 1
    },
    {
      "map": "world",
      "x": 1,
      "y": 1,
      "toMap": "world",
      "toX": 9,
      "toY": 6
    }
  ],
  "interiors": [
    {
      "id": "cabin",
      "w": 7,
      "h": 5,
      "grid": [
        "🏝🏝🏝🏝🏝🏝🏝",
        "🏝🪨🪨🪨🪨🪨🏝",
        "🏝🪨🪨🪨🪨🪨🏝",
        "🏝🪨🪨🪨🪨🪨🏝",
        "🏝🏝🏝🚪🏝🏝🏝"
      ],
      "entryX": 3,
      "entryY": 3
    }
  ],
  "buildings": [
    {
      "x": 10,
      "y": 9,
      "interiorId": "cabin",
      "boarded": false
    }
  ]
}